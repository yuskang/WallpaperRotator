---
index: 1
gemini_id: 50f7bfc40ac1d7e0
synced_at: 2026-01-29T06:32:52.744Z
---

## Q

在Q7311上因為可使用平板模式，是否可以讓它在旋轉時，桌面也伴隨更換，而非固定

## A

Windows 10 和 11 的原生設定**並不支援**「依據螢幕方向（橫向/直向）自動切換不同桌布」。原生功能只能選擇讓同一張圖片「填滿」或「置中」，這在平板直立時通常會導致橫向桌布被醜陋地裁切。

要在您的 Fujitsu Q7311 上實現這個功能，最輕量且不需安裝大型軟體的方法是使用 **PowerShell 腳本**。

以下是為您準備的解決方案，讓它在背景偵測螢幕旋轉並自動換圖。

### 方法：使用 PowerShell 自動偵測並切換

這個腳本會每隔幾秒檢查一次螢幕的長寬比，如果是直向就換直圖，橫向就換橫圖。

#### 步驟 1：準備圖片

找兩張圖片，分別重新命名並放在一個固定的資料夾中（例如 `C:\Wallpapers`）：

1.  **Landscape.jpg** (橫向桌布)
    
2.  **Portrait.jpg** (直向桌布)
    

#### 步驟 2：建立自動切換腳本

1.  在桌面上按右鍵 -> 新增 ->文字文件。
    
2.  將以下程式碼複製貼上：
    

```
Add-Type @"
using System;
using System.Runtime.InteropServices;
using Microsoft.Win32;

public class Wallpaper {
    [DllImport("user32.dll", CharSet = CharSet.Auto)]
    public static extern int SystemParametersInfo(int uAction, int uParam, string lpvParam, int fuWinIni);
}
"@

# --- 設定圖片路徑 (請修改這裡) ---
$LandscapePath = "C:\Wallpapers\Landscape.jpg"
$PortraitPath = "C:\Wallpapers\Portrait.jpg"
# --------------------------------

$SPI_SETDESKWALLPAPER = 0x0014
$UpdateIniFile = 0x01
$SendWinIniChange = 0x02
$CurrentState = "Unknown"

while ($true) {
    Add-Type -AssemblyName System.Windows.Forms
    $Screen = [System.Windows.Forms.Screen]::PrimaryScreen
    $Width = $Screen.Bounds.Width
    $Height = $Screen.Bounds.Height

    if ($Width -gt $Height) {
        # 橫向模式
        if ($CurrentState -ne "Landscape") {
            [Wallpaper]::SystemParametersInfo($SPI_SETDESKWALLPAPER, 0, $LandscapePath, $UpdateIniFile -bor $SendWinIniChange)
            $CurrentState = "Landscape"
        }
    } else {
        # 直向模式
        if ($CurrentState -ne "Portrait") {
            [Wallpaper]::SystemParametersInfo($SPI_SETDESKWALLPAPER, 0, $PortraitPath, $UpdateIniFile -bor $SendWinIniChange)
            $CurrentState = "Portrait"
        }
    }
    # 每 3 秒檢查一次 (可自行調整)
    Start-Sleep -Seconds 3
}

```

3.  修改程式碼中 `$LandscapePath` 和 `$PortraitPath` 的路徑，確保指向您的圖片位置。
    
4.  儲存檔案，將檔名命名為 `AutoWallpaper.ps1` (副檔名要是 .ps1)。
    

#### 步驟 3：執行腳本

1.  對著 `AutoWallpaper.ps1` 按右鍵，選擇 **「使用 PowerShell 執行」**。
    
2.  現在試著旋轉您的 Q7311 平板，桌布應該會在旋轉完成後的 3 秒內自動切換。
    

* * *

### 如何讓它開機自動執行（隱藏視窗）

如果您覺得每次都要手動執行且會有一個藍色視窗很礙眼，可以透過一個簡單的 `.vbs` 檔來隱藏執行：

1.  新增一個文字文件，貼上以下內容：
    
    ```
    Set objShell = CreateObject("Wscript.Shell")
    objShell.Run "powershell.exe -ExecutionPolicy Bypass -File C:\路徑\到\你的\AutoWallpaper.ps1", 0
    
    ```
    
    _(請將路徑修改為您存放 ps1 檔的真實路徑)_
    
2.  將此檔案存為 `StartWP.vbs`。
    
3.  按下 `Win + R`，輸入 `shell:startup`，將這個 `StartWP.vbs` 捷徑或檔案放入該資料夾。
    
4.  以後開機就會自動在背景運作。
    

### 其他替代方案 (第三方軟體)

如果您不想使用腳本，可以使用第三方軟體，但通常比較佔資源：

*   **Wallpaper Engine (付費/Steam):** 功能強大，可以設定「依據顯示器配置」載入不同桌布，甚至支援動態桌布。
    
*   **Dual Monitor Tools (免費):** 雖然主打雙螢幕，但它包含針對不同解析度設定桌布的功能。
    

### 針對 Q7311 的特別提醒

Q7311 的旋轉是依賴重力感測器驅動（Fujitsu System Manager），有時候系統旋轉反應較慢，腳本設定的 `Start-Sleep -Seconds 3` 是為了避免系統還沒轉完就換圖導致破圖，您可以依據實際順暢度調整該秒數。
