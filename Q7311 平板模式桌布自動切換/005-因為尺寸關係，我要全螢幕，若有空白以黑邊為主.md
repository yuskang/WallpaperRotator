---
index: 5
gemini_id: 10f3d79a8e299b04
synced_at: 2026-01-29T06:32:52.849Z
---

## Q

因為尺寸關係，我要全螢幕，若有空白以黑邊為主

## A

沒問題，您需要的模式在 Windows 設定中稱為\*\*「符合 (Fit)」\*\*。

這個模式會**完整顯示整張圖片**，保持原始比例不裁切也不變形，不足的地方會留空（顯示背景色）。

請使用下方更新後的腳本。我已經將 `WallpaperStyle` 的數值改為 `6`，這代表「符合」。

### 更新後的 PowerShell 腳本

請將原本的 `AutoWallpaper.ps1` 內容完全替換為以下代碼：

```
Add-Type @"
using System;
using System.Runtime.InteropServices;
using Microsoft.Win32;

public class Wallpaper {
    [DllImport("user32.dll", CharSet = CharSet.Auto)]
    public static extern int SystemParametersInfo(int uAction, int uParam, string lpvParam, int fuWinIni);
}
"@

# --- 設定圖片路徑 (請確認您的路徑與副檔名正確) ---
$LandscapePath = "C:\Wallpapers\Landscape.png"
$PortraitPath = "C:\Wallpapers\Portrait.png"
# --------------------------------

$SPI_SETDESKWALLPAPER = 0x0014
$UpdateIniFile = 0x01
$SendWinIniChange = 0x02
$CurrentState = "Unknown"

# 定義修改桌布樣式的函數
function Set-WallpaperStyle {
    # WallpaperStyle 數值說明:
    # 2 = 延展 (Stretch) - 變形填滿
    # 6 = 符合 (Fit) - 完整顯示，留黑邊 <--- 您要的這個
    # 10 = 填滿 (Fill) - 裁切放大
    
    # 將樣式設定為 "6" (符合)
    Set-ItemProperty -Path "HKCU:\Control Panel\Desktop" -Name WallpaperStyle -Value "6"
    Set-ItemProperty -Path "HKCU:\Control Panel\Desktop" -Name TileWallpaper -Value "0"
}

while ($true) {
    Add-Type -AssemblyName System.Windows.Forms
    $Screen = [System.Windows.Forms.Screen]::PrimaryScreen
    $Width = $Screen.Bounds.Width
    $Height = $Screen.Bounds.Height

    if ($Width -gt $Height) {
        # 橫向模式
        if ($CurrentState -ne "Landscape") {
            Set-WallpaperStyle # 設定為「符合」模式
            [Wallpaper]::SystemParametersInfo($SPI_SETDESKWALLPAPER, 0, $LandscapePath, $UpdateIniFile -bor $SendWinIniChange)
            $CurrentState = "Landscape"
        }
    } else {
        # 直向模式
        if ($CurrentState -ne "Portrait") {
            Set-WallpaperStyle # 設定為「符合」模式
            [Wallpaper]::SystemParametersInfo($SPI_SETDESKWALLPAPER, 0, $PortraitPath, $UpdateIniFile -bor $SendWinIniChange)
            $CurrentState = "Portrait"
        }
    }
    # 每 2 秒檢查一次
    Start-Sleep -Seconds 2
}

```

### ⚠️ 重要設定：確保邊框是「黑色」的

這個腳本設定的是「圖片顯示方式」，但**留白的顏色**取決於您 Windows 原本的設定。如果您的系統預設背景色是藍色，留邊就會變成藍色。

為了確保它是完美的**黑邊**，請您**手動執行一次**以下步驟（只需做一次）：

1.  在桌面上按右鍵 -> **個人化 (Personalize)**。
    
2.  選擇 **背景 (Background)**。
    
3.  在「個人化您的背景」下拉選單中，暫時切換成 **純色 (Solid color)**。
    
4.  在顏色選單中選擇 **黑色**。
    
5.  設定完後，再把選單切回 **圖片**（或者直接執行上面的腳本即可）。
    

這樣做是為了讓 Windows 記住「底色是黑色」，之後腳本執行「符合」模式時，露出的背景就會是純黑色的。
