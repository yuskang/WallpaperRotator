{"nodes":[{"id":"n1","type":"text","text":"### 💡 核心問題與PowerShell方案\n\n• Windows原生功能[[不支援]]依螢幕方向自動切換桌布。\n• 在[[平板模式]]下，直立時橫向桌布會被裁切或留白，影響美觀。\n• 提出使用[[PowerShell腳本]]作為輕量級解決方案，自動偵測螢幕旋轉並切換桌布。\n\n<div style=\"border-top: 1px dashed var(--text-faint); margin: 8px 0;\"></div>\n\n<small style=\"opacity: 0.7;\">[[Gemini/Q7311 平板模式桌布自動切換/001-在Q7311上因為可使用平板模式，是否可以讓它在旋轉時，桌面也伴隨更換，而非固定.md|QA1]]</small>","x":200,"y":90,"width":520,"height":274,"color":"6"},{"id":"n2","type":"text","text":"### 🖼️ 桌布格式要求與轉檔\n\n• Windows底層API[[不支援]].jxl (JPEG XL) 格式作為桌布，可能導致[[黑畫面]]。\n• 建議將圖片轉存為[[.png]] (無損) 或[[.jpg]] (常用) 格式。\n• 推薦使用[[Squoosh]]或[[ImageMagick]]等工具進行轉檔，而非直接更改檔名。\n\n<div style=\"border-top: 1px dashed var(--text-faint); margin: 8px 0;\"></div>\n\n<small style=\"opacity: 0.7;\">[[Gemini/Q7311 平板模式桌布自動切換/002-可使用.md|QA2]] [[Gemini/Q7311 平板模式桌布自動切換/003-如何把.md|QA3]] [[Gemini/Q7311 平板模式桌布自動切換/006-不行，在VScode上面編輯後運行此powershell螢幕全黑了.md|QA6]]</small>","x":50,"y":464,"width":380,"height":298,"color":"1"},{"id":"n3","type":"text","text":"### ⚙️ 桌布顯示模式設定\n\n• 腳本預設會沿用Windows現有桌布樣式，需修改[[機碼]]強制設定。\n• 推薦使用[[符合模式]] (Fit, 數值6)，保持圖片完整比例不裁切不變形。\n• 不足處會留空，可手動設定Windows背景色為[[黑色]]以實現黑邊效果。\n\n<div style=\"border-top: 1px dashed var(--text-faint); margin: 8px 0;\"></div>\n\n<small style=\"opacity: 0.7;\">[[Gemini/Q7311 平板模式桌布自動切換/004-上述powershell語法是否考慮設置桌布時，以全螢幕模式.md|QA4]] [[Gemini/Q7311 平板模式桌布自動切換/005-因為尺寸關係，我要全螢幕，若有空白以黑邊為主.md|QA5]]</small>","x":490,"y":464,"width":380,"height":298,"color":"4"},{"id":"group-p1","type":"group","label":"階段一: 核心問題與初步解決方案","x":0,"y":0,"width":920,"height":812,"color":"6"},{"id":"n4","type":"text","text":"### 🚧 腳本執行與視窗隱藏挑戰\n\n• [[VBScript]]與[[工作排程器]]在隱藏PowerShell視窗時常因路徑、權限或編碼問題而失效。\n• 引入[[PowerShell自我隱藏]]技術，讓腳本啟動後自行呼叫Windows API隱藏視窗，提高穩定性。\n\n<div style=\"border-top: 1px dashed var(--text-faint); margin: 8px 0;\"></div>\n\n<small style=\"opacity: 0.7;\">[[Gemini/Q7311 平板模式桌布自動切換/008-vbs無作用.md|QA8]] [[Gemini/Q7311 平板模式桌布自動切換/009-工作排程器不行.md|QA9]]</small>","x":1540,"y":90,"width":520,"height":250,"color":"6"},{"id":"n5","type":"text","text":"### ✅ 啟動捷徑的正確配置\n\n• 避免Windows詢問開啟方式，需建立一個帶有執行指令的[[啟動捷徑]]。\n• 捷徑目標應為 `powershell.exe -ExecutionPolicy Bypass -File \"C:\\您的路徑\\AutoWallpaper.ps1\" -WindowStyle Hidden`。\n• 將此捷徑放置於`shell:startup`資料夾中，實現開機自動靜默執行。\n\n<div style=\"border-top: 1px dashed var(--text-faint); margin: 8px 0;\"></div>\n\n<small style=\"opacity: 0.7;\">[[Gemini/Q7311 平板模式桌布自動切換/011-windows詢問我要選擇哪個應用程式開啟.md|QA11]]</small>","x":1170,"y":440,"width":380,"height":322,"color":"4"},{"id":"n6","type":"text","text":"### ❌ 腳本運行異常排查\n\n• [[黑畫面]]通常是圖片路徑錯誤或格式不支援導致。\n• 開機時出現[[False與1字樣]]是因腳本過早嘗試隱藏視窗及API回傳值被印出。\n• [[只切換一次]]後失效，是因`Add-Type`重複載入元件導致後續偵測邏輯被跳過。\n• `Add-Type`的[[語法錯誤]] (如`using`宣告) 會導致腳本無法編譯。\n\n<div style=\"border-top: 1px dashed var(--text-faint); margin: 8px 0;\"></div>\n\n<small style=\"opacity: 0.7;\">[[Gemini/Q7311 平板模式桌布自動切換/006-不行，在VScode上面編輯後運行此powershell螢幕全黑了.md|QA6]] [[Gemini/Q7311 平板模式桌布自動切換/013-仍然有執行異常，開機時自動自行，powershell視窗不會隱藏，視窗會出現fa.md|QA13]] [[Gemini/Q7311 平板模式桌布自動切換/014-只自動切換一次就不會自動切換了.md|QA14]] [[Gemini/Q7311 平板模式桌布自動切換/015-需要重新執行一次.md|QA15]] [[Gemini/Q7311 平板模式桌布自動切換/016-AddType_cUsersQ7311AppDataLocalTempz1yfj.md|QA16]]</small>","x":1610,"y":440,"width":380,"height":346,"color":"1"},{"id":"n7","type":"text","text":"### ✨ 最終穩定版腳本 (V5)\n\n• 整合所有修正，包括強制靜音、延遲啟動、雙重隱藏機制。\n• 將`Add-Type`元件載入移至迴圈外，並使用正確的`-TypeDefinition`參數。\n• 確保腳本在背景持續、穩定地監控螢幕旋轉並切換桌布，解決了所有已知問題。\n\n<div style=\"border-top: 1px dashed var(--text-faint); margin: 8px 0;\"></div>\n\n<small style=\"opacity: 0.7;\">[[Gemini/Q7311 平板模式桌布自動切換/010-依此版本全powershell方式，更新我稍早要求產出的markdown教程.md|QA10]] [[Gemini/Q7311 平板模式桌布自動切換/012-將教程，拿掉關於.md|QA12]] [[Gemini/Q7311 平板模式桌布自動切換/016-AddType_cUsersQ7311AppDataLocalTempz1yfj.md|QA16]]</small>","x":2050,"y":440,"width":380,"height":298,"color":"4"},{"id":"group-p2","type":"group","label":"階段二: 腳本優化與部署","x":1120,"y":0,"width":1360,"height":836,"color":"4"}],"edges":[{"id":"edge-inner-n1-n2","fromNode":"n1","toNode":"n2","fromSide":"bottom","toSide":"top","color":"0"},{"id":"edge-inner-n1-n3","fromNode":"n1","toNode":"n3","fromSide":"bottom","toSide":"top","color":"0"},{"id":"edge-inner-n4-n5","fromNode":"n4","toNode":"n5","fromSide":"bottom","toSide":"top","color":"0"},{"id":"edge-inner-n4-n6","fromNode":"n4","toNode":"n6","fromSide":"bottom","toSide":"top","color":"0"},{"id":"edge-inner-n4-n7","fromNode":"n4","toNode":"n7","fromSide":"bottom","toSide":"top","color":"0"},{"id":"edge-ai-0","fromNode":"n1","toNode":"n2","label":"需考慮","fromSide":"bottom","toSide":"top","color":"4"},{"id":"edge-ai-1","fromNode":"n1","toNode":"n3","label":"需配置","fromSide":"bottom","toSide":"top","color":"4"},{"id":"edge-ai-2","fromNode":"n1","toNode":"n4","label":"需解決","fromSide":"right","toSide":"left","color":"0"},{"id":"edge-ai-3","fromNode":"n4","toNode":"n5","label":"部署方式","fromSide":"bottom","toSide":"top","color":"4"},{"id":"edge-ai-4","fromNode":"n4","toNode":"n6","label":"可能導致","fromSide":"bottom","toSide":"top","color":"4"},{"id":"edge-ai-6","fromNode":"n6","toNode":"n7","label":"解決方案","fromSide":"right","toSide":"left","color":"4"},{"id":"edge-ai-7","fromNode":"n5","toNode":"n7","label":"運行","fromSide":"right","toSide":"left","color":"4"}]}