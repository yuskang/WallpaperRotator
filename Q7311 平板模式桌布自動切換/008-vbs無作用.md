---
index: 8
gemini_id: 11bd917c9e6b019b
synced_at: 2026-01-29T06:32:52.896Z
---

## Q

vbs無作用

## A

VBScript (VBS) 雖然方便，但非常容易因為**路徑中有空白**、**權限不足**或**編碼問題**而失效且沒有任何錯誤訊息（因為我們設定了 `, 0` 來隱藏視窗）。

請依照以下順序排查，通常是**第 1 點**或**第 3 點**的問題。

* * *

### 1\. 最常見原因：路徑中有「空白」但沒加引號

如果您的 `.ps1` 檔案放在桌面或包含空白的路徑（例如 `C:\Users\My Name\Desktop\...`），原本的寫法會失效。

**修正寫法：** 請將 `.vbs` 檔案內容修改如下，注意路徑前後多了**三對引號** `"""`，這是 VBS 處理路徑空白的特殊語法：

```
Set objShell = CreateObject("Wscript.Shell")
' 注意：路徑前後要包覆三對引號，以防路徑中有空白
objShell.Run "powershell.exe -ExecutionPolicy Bypass -File """ & "C:\您的路徑\AutoWallpaper.ps1" & """", 0

```

_(請將 `C:\您的路徑\AutoWallpaper.ps1` 換成您真實的路徑)_

* * *

### 2\. 測試是否為 PowerShell 權限被擋

有時候即便加了 `-ExecutionPolicy Bypass`，系統還是會擋。我們來測試一下指令是否正確。

1.  按下 `Win + R`。
    
2.  複製貼上以下指令（**記得修改成您的真實路徑**）並按 Enter：
    
    ```
    powershell.exe -NoExit -ExecutionPolicy Bypass -File "C:\您的路徑\AutoWallpaper.ps1"
    
    ```
    
3.  **觀察結果**：
    
    *   **如果出現藍底白字視窗且沒有紅字錯誤**：代表 PowerShell 指令沒問題，是 VBS 寫錯了（請回頭檢查第 1 點）。
        
    *   **如果視窗一閃即逝或出現紅字**：代表 PowerShell 腳本本身有錯（路徑不對或權限不足）。
        

* * *

### 3\. 替代方案：改用「工作排程器」 (更穩定，推薦)

如果 VBS 一直搞不定，Windows 內建的**工作排程器 (Task Scheduler)** 是最正規的做法，而且絕對有效。

**設定步驟：**

1.  按下 `Win + S` 搜尋 **「工作排程器」** 並開啟。
    
2.  點選右側的 **「建立工作...」 (Create Task)**。
    
3.  **【一般】分頁**：
    
    *   名稱：隨便取，例如 `AutoWallpaper`。
        
    *   勾選 **「以最高權限執行」**。
        
    *   設定為 **「設定為 Windows 10」** (或 11)。
        
4.  **【觸發程序】分頁**：
    
    *   點選「新增」。
        
    *   開始工作選擇： **「登入時」**。
        
    *   按確定。
        
5.  **【動作】分頁**：
    
    *   點選「新增」。
        
    *   動作：**啟動程式**。
        
    *   **程式/指令**：填入 `powershell.exe`
        
    *   **新增引數 (非必要)**：複製貼上以下內容 (注意修改路徑)：
        
        ```
        -WindowStyle Hidden -ExecutionPolicy Bypass -File "C:\您的路徑\AutoWallpaper.ps1"
        
        ```
        
        _(這裡的 `-WindowStyle Hidden` 就是用來隱藏黑視窗的關鍵)_
        
    *   按確定。
        
6.  **【條件】分頁** (重要！)：
    
    *   **取消勾選** 「只有在電腦使用 AC 電源時才啟動」。(不然平板拔掉電源程式就停了)
        
7.  按 **「確定」** 儲存。
    

**如何測試？** 在工作排程器列表中找到您剛建立的 `AutoWallpaper`，按右鍵選 **「執行」**。如果桌布開始會隨旋轉切換，代表成功了！以後開機它就會自動跑。
